<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" href="../images/logo1.png" type="image/png">
        <title>Blog Post</title>
        <link rel="stylesheet" href="../output.css">
        <style>
                /* Loading Overlay Styles */
                #loading-overlay {
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background-color: rgba(255, 255, 255, 0.9);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        z-index: 1000;
                        /* Ensure it's on top */
                }

                .loader {
                        border: 8px solid #f3f3f3;
                        border-top: 8px solid #3498db;
                        border-radius: 50%;
                        width: 60px;
                        height: 60px;
                        animation: spin 1s linear infinite;
                }

                @keyframes spin {
                        0% {
                                transform: rotate(0deg);
                        }

                        100% {
                                transform: rotate(360deg);
                        }
                }

                /* Hide main content initially */
                .content {
                        display: none;
                }

                /* Show main content when loaded */
                .content.loaded {
                        display: flex;
                }
        </style>
</head>

<body class="h-full">
        <!-- Loading Overlay -->
        <div id="loading-overlay">
                <div class="loader"></div>
        </div>

        <div class="wrapper min-h-[100vh] flex flex-col w-full content">
                <!-- Navbar -->
                <nav>
                        <div class="navbar bg-base-100">
                                <div class="flex-1">
                                        <a href="./index.html" class="btn btn-ghost text-xl">
                                                <img src="../images/logo.svg" alt="Logo" height="50" width="50">
                                        </a>
                                </div>
                                <div class="flex-none gap-2">
                                        <div class="dropdown dropdown-end">
                                                <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar">
                                                        <div class="w-10 rounded-full">
                                                                <img alt="Profile Avatar"
                                                                        src="../images/profile-avatar.png" />
                                                        </div>
                                                </div>
                                                <ul tabindex="0"
                                                        class="menu menu-sm dropdown-content bg-base-100 rounded-box z-[1] mt-3 w-52 p-2 shadow">
                                                        <li>
                                                                <a href="./admin.html" id="adminBtn">
                                                                        Admin Panel

                                                                </a>
                                                        </li>
                                                        <li><a href="./login.html" id="loginBtn">Login</a></li>
                                                        <li><a href="#" id="logoutBtn">Logout</a></li>
                                                </ul>
                                        </div>
                                </div>
                        </div>
                </nav>

                <!-- Blog Container -->
                <section
                        class="blog-container-main flex flex-col space-y-7 flex-1 mx-auto p-2 items-center text-center w-11/12 md:w-9/12 pb-10">
                        <!-- Blog Title -->
                        <h1 class="blog-title text-4xl md:text-7xl" id="blog-title">Loading...</h1>

                        <!-- Blog Author & Social Links -->
                        <div class="flex justify-between items-center mt-4 w-full">
                                <div class="author-thumbnail flex items-center space-x-2">
                                        <img src="../images/profile-avatar.png" alt="Author Avatar"
                                                class="w-10 h-10 rounded-full" id="author-avatar">
                                        <div class="author-details flex flex-col">
                                                <p class="author-name text-xs md:text-sm font-bold" id="author-name">
                                                        Loading Author...</p>
                                                <p class="date-published text-xs md:text-sm text-gray-500"
                                                        id="date-published">Loading Date...</p>
                                        </div>
                                </div>
                                <ul class="social-media-link flex space-x-4">
                                        <li class="facebook-link"><a href="#" aria-label="Facebook">F</a></li>
                                        <li class="twitter-link"><a href="#" aria-label="Twitter">T</a></li>
                                        <li class="share-link"><a href="#" aria-label="Share">S</a></li>
                                </ul>
                        </div>

                        <!-- Header Image -->
                        <img src="../images/header-imager.jpg" alt="Header Image"
                                class="mt-4 w-full rounded-2xl shadow-md shadow-[#151515]/50" id="header-image">

                        <!-- Blog Details -->
                        <div
                                class="blog-details px-8 py-4 bg-neutral mx-auto w-11/12 md:w-10/12 rounded-2xl shadow-md shadow-[#151515]/50">
                                <div class="blog-details text-left text-wrap" id="blog-content">
                                        <p class="text-[12px] md:text-base">Loading content...</p>
                                </div>
                        </div>
                </section>

                <!-- Footer Divider -->
                <div class="divider divider-info opacity-10">This Ain't What You Expected</div>

                <!-- Footer -->
                <footer class="footer footer-center bg-base-200 text-base-content rounded p-10">
                        <nav class="grid grid-flow-col gap-4">
                                <a class="link link-hover">About us</a>
                                <a class="link link-hover">Contact</a>
                                <a class="link link-hover">Jobs</a>
                                <a class="link link-hover">Press kit</a>
                        </nav>
                        <nav>
                                <div class="grid grid-flow-col gap-4">
                                        <a href="#" aria-label="Facebook">
                                                <!-- Facebook SVG Icon -->
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                        viewBox="0 0 24 24" class="fill-current">
                                                        <path
                                                                d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z">
                                                        </path>
                                                </svg>
                                        </a>
                                        <a href="#" aria-label="YouTube">
                                                <!-- YouTube SVG Icon -->
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                        viewBox="0 0 24 24" class="fill-current">
                                                        <path
                                                                d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z">
                                                        </path>
                                                </svg>
                                        </a>
                                        <a href="#" aria-label="Twitter">
                                                <!-- Twitter SVG Icon -->
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                        viewBox="0 0 24 24" class="fill-current">
                                                        <path
                                                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z">
                                                        </path>
                                                </svg>
                                        </a>
                                </div>
                        </nav>
                        <aside>
                                <p>&copy; <span id="current-year"></span> - All rights reserved by ACME Industries Ltd
                                </p>
                        </aside>
                </footer>
        </div>

        <!-- JavaScript to Fetch and Display Single Post -->
        <script>
                document.addEventListener('DOMContentLoaded', () => {
                        // Function to get query parameters
                        function getQueryParam(param) {
                                const urlParams = new URLSearchParams(window.location.search);
                                return urlParams.get(param);
                        }

                        // Get the post ID from the URL
                        const postId = getQueryParam('id');

                        if (!postId) {
                                alert('No post ID provided in the URL.');
                                // Redirect to home page
                                window.location.href = 'index.html';
                                return;
                        }

                        // Define the API endpoint
                        const apiEndpoint = `http://localhost:5000/api/posts/${postId}`;

                        // Fetch the post data
                        fetch(apiEndpoint)
                                .then(response => {
                                        if (!response.ok) {
                                                if (response.status === 404) {
                                                        throw new Error('Post not found.');
                                                } else {
                                                        throw new Error(`HTTP error! status: ${response.status}`);
                                                }
                                        }
                                        return response.json();
                                })
                                .then(data => {
                                        // Populate the HTML elements with data
                                        document.getElementById('blog-title').textContent = data.title || 'No Title';
                                        document.getElementById('author-name').textContent = data.author || 'Unknown Author';
                                        document.getElementById('date-published').textContent = data.createdAt ? new Date(data.createdAt).toLocaleDateString() : 'Unknown Date';
                                        document.getElementById('header-image').src = data.headerImage || '../images/default-header.jpg';
                                        document.getElementById('header-image').alt = data.title || 'Header Image';

                                        // Populate blog content
                                        const blogContent = data.description || 'No Description Available';
                                        document.getElementById('blog-content').innerHTML = blogContent;

                                        // Optionally, update author avatar if available
                                        if (data.authorAvatarUrl) {
                                                document.getElementById('author-avatar').src = data.authorAvatarUrl;
                                        }

                                        // Update current year in footer
                                        document.getElementById('current-year').textContent = new Date().getFullYear();

                                        // Reveal the main content
                                        const mainContent = document.querySelector('.content');
                                        if (mainContent) {
                                                mainContent.classList.add('loaded');
                                        }

                                        // Hide the loading overlay
                                        const loadingOverlay = document.getElementById('loading-overlay');
                                        if (loadingOverlay) {
                                                loadingOverlay.style.display = 'none';
                                        }
                                })
                                .catch(error => {
                                        console.error('Error fetching the post:', error);
                                        alert(error.message);

                                        // Optionally, redirect to home page or display a custom error message
                                        window.location.href = 'index.html';
                                });
                });
        </script>
        <script src="../scripts/scripts.js"></script>
</body>

</html>